requirejs.config({paths:{lodash:"../lib/lodash/lodash.min",Store:"ProductList/Store.min",Cart:"ProductList/Cart.min",PubSub:"ProductList/PubSub.min",Utils:"ProductList/Utils.min",Themes:"ProductList/Themes.min",Mock:"ProductList/Mock.min"}}),requirejs(["Store","Utils","PubSub","Cart","Themes","lodash"],function(a,b,c,d,e,f){"use strict";function g(){return f.pluck(Q,"dataset.header")}function h(){y(),z(),A(),B()}function i(a){var b=0,c=a.length>V?V:a.length,d=document.createDocumentFragment();for(b;c>b;b++)d.appendChild(k(a[b],c));return d}function j(a,b){var c=null;c=i(b),a.appendChild(c),h()}function k(b,c){var d=document.createElement("div"),e=null,g=b instanceof a.ItemOnSale,h=!b.isInStock();return d.className+=" table-row",g&&(d.className+=" item-on-sale"),h&&(d.className+=" item-out-of-stock"),f.forIn(T,function(a){e=document.createElement("div"),e.innerHTML=b.data[a],g&&"price"===a&&(e.innerHTML='<div class="discounted">'+b.data[a]+"<div>",e.innerHTML+='<div class="real-price">'+b.getPrice()+"&dollar;<div>"),e.className="table-cell item-"+a,d.appendChild(e)}),d.appendChild(l(b.getId())),m(d,c),d}function l(a){var b=document.createElement("div");return b.className="table-cell",b.innerHTML='<input type="number" disabled="disabled" data-itemid="'+a+'" />',b.innerHTML+='<button class="btn btn-primary btn-xs change-amount" data-action="-1">-</button>',b.innerHTML+='<button class="btn btn-primary btn-xs change-amount" data-action="1">+</button>',b}function m(a,b){var c=a.querySelector(".item-id"),d=document.createElement("div"),e=document.createElement("select");e.innerHTML=n(1,b+1),e.addEventListener("change",function(){x(this)}),d.className="table-cell select-order",d.appendChild(e),a.insertBefore(d,c)}function n(a,b){var c="";return f.forIn(f.range(a,b),function(a){c+='<option value="'+a+'">'+a+"</option>"}),c}function o(a){function c(){this.dispatchEvent(U)}var d=0,e=b.convertToArray(a.querySelectorAll("[data-pagenum]"));f(e).forEach(function(a){d=a.dataset.pagenum,a.addEventListener("moveToPageEvent",v.bind(null,d)),a.addEventListener("click",c)}).value()}function p(){var a=document.getElementById("items-per-page");a.addEventListener("change",t),a.value=V}function q(a){document.getElementsByClassName("container")[0].appendChild(a)}function r(a){var b=document.createElement("nav"),c=document.querySelector(".pagination-container"),d='<ul class="pagination">',e=Math.ceil(a.length/V);f.forIn(f.range(1,e+1),function(a){d+='<li><a href="#" data-pagenum="'+a+'">'+a+"</a></li>"}),d+='</ul><select id="items-per-page" class="per-page-selection">',d+=n(5,11),d+="</select>",b.className="pagination-container",b.innerHTML=d,c&&c.remove(),o(b),q(b),p()}function s(){var a=document.createElement("div");a.className="cart",a.innerHTML='<input type="number" disabled="disabled" id="cart-input" />',q(a)}function t(){V=parseInt(this.value,10),r(O),v(1)}function u(){var a=document.createElement("div"),c=document.getElementById("cart-summery"),e=d.getItemsSummary(),g="",h=null;f.forIn(e,function(a,c){a>0&&(h=b.getItemById(O,c),g+="<li>"+a+" - "+h.getName()+"</li>")}),g="<ul>"+g+"</ul>",c&&c.remove(),a.innerHTML=g,a.className="items-summery",a.id="cart-summery",q(a)}function v(a){w(R),j(R,O.slice(a*V-V,a*V)),W=a}function w(a){a.innerHTML=""}function x(a){var b,c=parseInt(a.selectedOptions[0].value,10),d=R.removeChild(a.parentElement.parentElement);b=document.querySelector(".tbody .table-row:nth-child("+c+")"),b?R.insertBefore(d,b):R.appendChild(d),y()}function y(){var a=document.getElementById("products").children;f(a).forEach(function(a,b){a.querySelector(".select-order select").selectedIndex=b}).value()}function z(){var a=document.querySelectorAll(".item-image");f(a).forEach(function(a){a.innerHTML='<img src="'+a.innerHTML+'" />'}).value()}function A(){var a=document.querySelectorAll(".item-description");f(a).forEach(function(a){a.innerHTML="<div>"+a.innerHTML+"</div>"}).value()}function B(){var a=document.querySelectorAll("[data-itemid]"),b="",c=0;f(a).forEach(function(a){b=a.dataset.itemid,c=parseInt(d.getItemCount(b),10),a.value=c}).value()}function C(a,b,c){var d=parseInt(b.value,10),e=a>0&&d===c.getStock(),f=0>a&&0===d;return f||e}function D(a){return a.className.match("change-amount")}function E(){P.addEventListener("click",function(a){var c=a.target,e=null,f=null,g=null;if(D(c)){if(e=c.parentElement.querySelector("[data-itemid]"),f=b.getItemById(O,e.dataset.itemid),g=parseInt(c.dataset.action,10),e.value=e.value||0,C(g,e,f))return;d.updateItem(f.getId(),g)}})}function F(a){var b=document.querySelector('[data-itemid="'+a+'"]');b.value=d.getItemCount(a)}function G(){S.addEventListener("click",function(a){var d=a.target,e=d.dataset.header;e&&(b.sortItemObjectsByProperty(O,e),c.publish("itemsSorted",[]))})}function H(){w(R),j(R,O),v(W)}function I(){var a={itemsSorted:[H],couponApplied:[M],orderCommitted:[M,u],itemUpdated:[u,F]};f.forIn(a,function(a,b){f(a).forEach(function(a){c.subscribe(b,a)}).value()})}function J(){E(),G(),L(),K()}function K(){var a=document.getElementById("order-form");a.addEventListener("submit",function(a){a.preventDefault(),d.commitOrder()})}function L(){var b=document.getElementById("coupon-form"),c=document.getElementById("coupon-code"),d=a.getCoupons();b.addEventListener("submit",function(a){var b=c.value,e=f.reduce(d,function(a,c){return c.validate(b).apply()||a},!1);a.preventDefault(),e||alert("Wrong coupon code!"),c.value=""})}function M(){O=a.getProducts(),v(W)}function N(){I(),J(),v(1),r(O),s(),e.createThemeChanger()}var O=a.getProducts(),P=document.getElementById("main-table"),Q=P.querySelectorAll("[data-header]"),R=document.getElementById("products"),S=document.getElementById("table-header"),T=g(),U=new CustomEvent("moveToPageEvent"),V=5,W=1;return N(),{handleChange:x,refresh:M,moveToPage:v}});